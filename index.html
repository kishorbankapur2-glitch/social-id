<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kishor | Social Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body{
  margin:0;
  min-height: 100vh;
  min-height: 100dvh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at top, #2e2e2e, #1a1a1a);
  font-family:system-ui,sans-serif;
  color:#fff;
  position: relative;
  overflow-x: hidden;
}

/* Main Card */
.card{
  width: min(350px, 80vw);
  padding: clamp(24px, 4vw, 32px);
  border-radius: min(28px, 5vw);
  background:rgba(255,255,255,.12);
  backdrop-filter:blur(14px);
  box-shadow:0 0 50px rgba(0,0,0,.45);
  text-align:center;
  position: relative;
  z-index: 2;
  margin: auto;
  max-width: 400px;
}

/* Profile Photo */
.avatar-container {
  position: relative;
  width: min(120px, 25vw);
  height: min(120px, 25vw);
  margin: 0 auto 20px auto;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

.avatar-img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid rgba(255,255,255,0.3);
  box-shadow: 0 0 30px rgba(56, 189, 248, 0.5);
  transition: transform 0.3s ease;
}

.avatar-img:hover {
  transform: scale(1.05);
}

h2{
  margin: 0 0 10px 0;
  font-size: clamp(1.5rem, 5vw, 2rem);
  background: linear-gradient(135deg, #fff, #94a3b8);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.subtitle{
  opacity:.75;
  margin-bottom: 25px;
  font-size: clamp(1rem, 4vw, 1.2rem);
  color: #94a3b8;
}

/* Social Links */
a{
  display:flex;
  align-items:center;
  justify-content: center;
  gap: 15px;
  padding: 15px 20px;
  margin: 12px auto;
  width: 100%;
  max-width: 300px;
  border-radius: 50px;
  text-decoration:none;
  color:white;
  background:rgba(255,255,255,.14);
  font-size: 1.1rem;
  transition: all 0.3s ease;
  border: 1px solid rgba(255,255,255,0.1);
}

a:hover{
  background:rgba(255,255,255,.25);
  transform: scale(1.02);
  border-color: rgba(255,255,255,0.3);
}

i{
  font-size: 24px;
  width: 30px;
  text-align: center;
}

/* Developer Button */
.developer-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(30, 30, 40, 0.85);
  backdrop-filter: blur(8px);
  border: 1.5px solid rgba(255, 215, 0, 0.4);
  color: #e0e0e0;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  padding: 8px 18px;
  border-radius: 30px;
  cursor: pointer;
  z-index: 1500;
  transition: all 0.3s ease;
  letter-spacing: 0.5px;
  font-weight: 500;
  box-shadow: 0 4px 15px rgba(0,0,0,0.5);
  text-transform: uppercase;
}

.developer-btn:hover {
  border-color: gold;
  color: gold;
  background: rgba(40, 40, 50, 0.95);
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
  transform: scale(1.05);
}

/* Music Emoji */
.music-mini {
  position: fixed;
  bottom: 25px;
  right: 25px;
  z-index: 1000;
}

.music-emoji {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: rgba(30,30,40,0.7);
  backdrop-filter: blur(5px);
  border: 2px solid rgba(255,255,255,0.2);
  color: white;
  font-size: 40px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  box-shadow: 0 5px 20px rgba(0,0,0,0.5);
  user-select: none;
}

.music-emoji:hover {
  transform: scale(1.1);
  border-color: rgba(255,215,0,0.5);
  box-shadow: 0 0 30px rgba(255,215,0,0.3);
}

.rotate-emoji {
  animation: spin 4s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Password Modal */
.password-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0);
  backdrop-filter: blur(0px);
  z-index: 3000;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.3s ease;
  pointer-events: none;
}

.password-modal.show {
  background: rgba(0,0,0,0.9);
  backdrop-filter: blur(12px);
  pointer-events: all;
}

.password-card {
  background: rgba(30, 30, 40, 0.95);
  padding: 30px 25px;
  border-radius: 40px;
  width: min(320px, 85vw);
  text-align: center;
  border: 2px solid #444;
  box-shadow: 0 20px 40px rgba(0,0,0,0.7);
  transform: scale(0.7);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.password-modal.show .password-card {
  transform: scale(1);
  opacity: 1;
  border-color: gold;
}

.password-card h3 {
  font-size: 2rem;
  margin-bottom: 15px;
  color: #e0e0e0;
  font-family: 'Courier New', monospace;
}

.password-card .dev-text {
  font-family: 'Courier New', monospace;
  color: #aaa;
  font-size: 1rem;
  margin-bottom: 25px;
  background: rgba(255,255,255,0.05);
  padding: 8px;
  border-radius: 30px;
}

.password-input {
  width: 100%;
  padding: 16px 20px;
  background: rgba(20,20,30,0.8);
  border: 2px solid #444;
  border-radius: 60px;
  font-size: 1.5rem;
  text-align: center;
  color: white;
  letter-spacing: 4px;
  margin-bottom: 25px;
  outline: none;
  font-family: 'Courier New', monospace;
}

.password-input:focus {
  border-color: gold;
  box-shadow: 0 0 20px rgba(255,215,0,0.3);
}

.password-card .actions {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.pass-btn {
  background: rgba(40,40,50,0.8);
  border: 2px solid #555;
  color: #e0e0e0;
  padding: 12px 30px;
  border-radius: 50px;
  font-size: 1.1rem;
  cursor: pointer;
  transition: all 0.2s;
  flex: 1;
  font-family: 'Courier New', monospace;
}

.pass-btn:hover {
  background: gold;
  color: black;
  border-color: gold;
  transform: scale(1.05);
}

.pass-btn.cancel {
  border-color: #ff4444;
  color: #ff8888;
}
.pass-btn.cancel:hover {
  background: #ff4444;
  border-color: #ff4444;
  color: white;
}

/* Developer Mode Panel */
.dev-panel {
  position: fixed;
  top: 0;
  right: -100%;
  width: min(450px, 95vw);
  height: 100vh;
  background: rgba(25, 25, 35, 0.98);
  backdrop-filter: blur(20px);
  border-left: 3px solid gold;
  box-shadow: -10px 0 40px rgba(0,0,0,0.7);
  z-index: 3500;
  transition: right 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  padding: 30px 20px;
  overflow-y: auto;
  color: #e0e0e0;
}

.dev-panel.open {
  right: 0;
}

.dev-panel h2 {
  font-size: 2rem;
  margin-bottom: 20px;
  border-bottom: 2px solid gold;
  padding-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 15px;
  font-family: 'Courier New', monospace;
  color: gold;
}

.dev-panel .close-panel {
  position: absolute;
  top: 20px;
  right: 25px;
  font-size: 40px;
  cursor: pointer;
  color: #aaa;
  transition: 0.2s;
}
.dev-panel .close-panel:hover {
  color: gold;
  transform: scale(1.2);
}

/* Tabs */
.dev-tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 25px;
  border-bottom: 1px solid #444;
  padding-bottom: 10px;
}

.dev-tab {
  padding: 10px 20px;
  border-radius: 30px;
  cursor: pointer;
  font-family: 'Courier New', monospace;
  transition: all 0.2s;
  background: rgba(255,255,255,0.05);
  flex: 1;
  text-align: center;
  color: #aaa;
}

.dev-tab.active {
  background: gold;
  color: black;
  font-weight: bold;
}

.dev-tab-content {
  display: none;
}

.dev-tab-content.active {
  display: block;
}

/* Photo Upload Area */
.upload-area {
  border: 3px dashed #555;
  border-radius: 40px;
  padding: 30px 20px;
  text-align: center;
  margin: 20px 0;
  cursor: pointer;
  transition: 0.2s;
  background: rgba(255,255,255,0.02);
}
.upload-area:hover {
  border-color: gold;
  background: rgba(255,215,0,0.05);
}
.upload-area i {
  font-size: 50px;
  color: gold;
  margin-bottom: 10px;
}

#fileInput {
  display: none;
}

.photo-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.photo-item {
  position: relative;
  aspect-ratio: 1/1;
  border-radius: 20px;
  overflow: hidden;
  border: 3px solid #555;
  transition: 0.2s;
}
.photo-item:hover {
  border-color: gold;
  transform: scale(1.02);
}
.photo-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.photo-item .delete-photo {
  position: absolute;
  top: 5px;
  right: 5px;
  background: rgba(0,0,0,0.7);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  transition: 0.2s;
  border: 2px solid gold;
}
.photo-item:hover .delete-photo {
  opacity: 1;
}
.photo-item .delete-photo:hover {
  background: red;
  border-color: white;
}

/* Visitor Section */
.visitor-section {
  margin-top: 20px;
}

.visitor-title {
  font-family: 'Courier New', monospace;
  color: gold;
  font-size: 1.3rem;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.visitor-stats {
  background: rgba(255,255,255,0.03);
  border-radius: 30px;
  padding: 20px;
  margin-bottom: 20px;
  border: 1px solid #444;
}

.stat-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  font-family: monospace;
  font-size: 1rem;
}

.stat-label {
  color: #aaa;
}

.stat-value {
  color: gold;
  font-weight: bold;
}

.visitor-list {
  max-height: 300px;
  overflow-y: auto;
  background: rgba(0,0,0,0.3);
  border-radius: 20px;
  padding: 15px;
  margin-bottom: 20px;
}

.visitor-entry {
  display: flex;
  justify-content: space-between;
  padding: 10px;
  border-bottom: 1px solid #333;
  font-family: monospace;
  font-size: 0.9rem;
}

.visitor-entry:last-child {
  border-bottom: none;
}

.visitor-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.visitor-email {
  color: #38bdf8;
  font-size: 0.9rem;
}

.visitor-time {
  color: #aaa;
  font-size: 0.75rem;
}

.clear-btn {
  background: rgba(255,0,0,0.1);
  border: 1px solid rgba(255,0,0,0.3);
  color: #ff8888;
  padding: 10px 20px;
  border-radius: 30px;
  cursor: pointer;
  font-family: 'Courier New', monospace;
  margin-top: 10px;
  transition: 0.2s;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.clear-btn:hover {
  background: rgba(255,0,0,0.3);
  color: white;
}

.empty-message {
  text-align: center;
  color: #aaa;
  padding: 20px;
  font-family: monospace;
}

/* Photo Zoom Modal */
.photo-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0);
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(0px);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

.photo-modal.show {
  background: rgba(0,0,0,0.95);
  backdrop-filter: blur(10px);
  pointer-events: all;
}

.modal-content {
  position: relative;
  width: 90vw;
  height: 90vh;
  display: flex;
  justify-content: center;
  align-items: center;
  transform: scale(0.5);
  opacity: 0;
  transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.photo-modal.show .modal-content {
  transform: scale(1);
  opacity: 1;
}

.modal-image {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 30px;
  border: 4px solid rgba(255,255,255,0.3);
  box-shadow: 0 0 30px rgba(56, 189, 248, 0.8);
}

.back-button {
  position: absolute;
  top: 30px;
  left: 30px;
  color: white;
  font-size: 24px;
  cursor: pointer;
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50px;
  background: rgba(0,0,0,0.3);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  z-index: 2001;
  border: 2px solid rgba(255,255,255,0.2);
  transform: translateX(-20px);
  opacity: 0;
  pointer-events: none;
}

.photo-modal.show .back-button {
  transform: translateX(0);
  opacity: 1;
  pointer-events: all;
}

@media (max-width: 480px) {
  .back-button { top: 20px; left: 20px; width: 50px; height: 50px; }
  .developer-btn { font-size: 12px; padding: 6px 14px; }
}
</style>
</head>

<body>
<div class="card">
  <div class="avatar-container" onclick="openPhoto()">
    <img src="photo1.png" alt="Kishor Bankapur" class="avatar-img" id="profilePhoto">
  </div>
  
  <h2>KISHOR BANKAPUR</h2>
  <p class="subtitle">@kishorbankapur</p>

  <a href="https://www.instagram.com/kishor.bankapur?igsh=djEzNmVjOXFqZXY1" target="_blank">
    <i class="fa-brands fa-instagram"></i> Instagram
  </a>
  <a href="https://x.com/bankapurkishor" target="_blank">
    <i class="fa-brands fa-x-twitter"></i> X / Twitter
  </a>
  <a href="https://www.linkedin.com/in/kishor-bankapur-9ba256325/" target="_blank">
    <i class="fa-brands fa-linkedin"></i> LinkedIn
  </a>
  <a href="https://youtube.com/@careless.2009-pi?si=w8D_u4yLM429y281" target="_blank">
    <i class="fa-brands fa-youtube"></i> Youtube
  </a>
</div>

<!-- Developer Button -->
<div class="developer-btn" onclick="openPasswordModal()">
  DEVELOPER
</div>

<!-- Password Modal -->
<div class="password-modal" id="passwordModal" onclick="closePasswordModal(event)">
  <div class="password-card" onclick="event.stopPropagation()">
    <h3>üîê ACCESS</h3>
    <div class="dev-text">only for developer</div>
    <input type="password" class="password-input" id="passwordInput" placeholder="****" maxlength="4" inputmode="numeric">
    <div class="actions">
      <button class="pass-btn" onclick="checkPassword()">ENTER</button>
      <button class="pass-btn cancel" onclick="closePasswordModal(event)">CANCEL</button>
    </div>
  </div>
</div>

<!-- Developer Mode Panel -->
<div class="dev-panel" id="devPanel">
  <div class="close-panel" onclick="closeDevPanel()">&times;</div>
  <h2><i class="fa-solid fa-terminal"></i> DEVELOPER MODE</h2>
  
  <div class="dev-tabs">
    <div class="dev-tab active" onclick="switchDevTab('photos')" id="tabPhotos">üì∏ PHOTOS</div>
    <div class="dev-tab" onclick="switchDevTab('visitors')" id="tabVisitors">üë• VISITORS</div>
  </div>
  
  <div class="dev-tab-content active" id="photosTab">
    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
      <i class="fa-solid fa-cloud-upload-alt"></i>
      <p>click to upload photos</p>
    </div>
    <input type="file" id="fileInput" accept="image/*" multiple onchange="handleFiles(this.files)">
    <div class="photo-grid" id="photoGrid"></div>
  </div>
  
  <div class="dev-tab-content" id="visitorsTab">
    <div class="visitor-section">
      <div class="visitor-title">
        <i class="fa-solid fa-clock"></i> VISITOR LOG
      </div>
      
      <div class="visitor-stats">
        <div class="stat-item">
          <span class="stat-label">TOTAL VISITS:</span>
          <span class="stat-value" id="totalVisits">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">LAST VISIT:</span>
          <span class="stat-value" id="lastVisitTime">NEVER</span>
        </div>
      </div>
      
      <div class="visitor-list" id="visitorList"></div>
      
      <button class="clear-btn" onclick="clearAllLogs()">
        <i class="fa-solid fa-trash"></i> CLEAR ALL LOGS
      </button>
    </div>
  </div>
</div>

<!-- Music -->
<div class="music-mini">
  <div class="music-emoji" onclick="toggleMusic()" id="musicEmoji">üóø</div>
</div>

<!-- Photo Zoom -->
<div class="photo-modal" id="photoModal" onclick="closePhoto(event)">
  <div class="back-button" onclick="closePhoto(event)"><i class="fa-solid fa-arrow-left"></i></div>
  <div class="modal-content"><img src="photo1.png" class="modal-image" alt="Kishor"></div>
</div>

<audio id="bgMusic" loop preload="auto"><source src="audio.mp3" type="audio/mpeg"></audio>

<script>
// ================== VISITOR TRACKING ==================
// Yeh function har baar call hoga jab bhi koi website open karega
function trackVisitor() {
  try {
    // Pehle se saved visitors ko lo
    let visitors = JSON.parse(localStorage.getItem('visitor_log')) || [];
    
    // Current time and date
    const now = new Date();
    const dateStr = now.toLocaleDateString('en-IN', {
      day: '2-digit',
      month: 'short',
      year: 'numeric'
    });
    const timeStr = now.toLocaleTimeString('en-IN', {
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: true
    });
    
    // Browser info (optional)
    const browser = navigator.userAgent;
    let browserName = 'Unknown';
    if (browser.includes('Chrome')) browserName = 'Chrome';
    else if (browser.includes('Firefox')) browserName = 'Firefox';
    else if (browser.includes('Safari')) browserName = 'Safari';
    else if (browser.includes('Edge')) browserName = 'Edge';
    else if (browser.includes('Opera')) browserName = 'Opera';
    
    // New visitor entry
    const visitorEntry = {
      id: Date.now() + Math.random(),
      email: 'GUEST',
      browser: browserName,
      date: dateStr,
      time: timeStr,
      fullTime: now.toISOString(),
      timestamp: now.getTime()
    };
    
    // Add to beginning of array (latest first)
    visitors.unshift(visitorEntry);
    
    // Limit to last 100 visitors (storage limit)
    if (visitors.length > 100) {
      visitors = visitors.slice(0, 100);
    }
    
    // Save to localStorage
    localStorage.setItem('visitor_log', JSON.stringify(visitors));
    
    console.log('New visitor tracked:', visitorEntry); // Debug ke liye
  } catch (e) {
    console.log('Tracking error:', e);
  }
}

// ================== PASSWORD MODAL ==================
const passwordModal = document.getElementById('passwordModal');
const devPanel = document.getElementById('devPanel');
const passwordInput = document.getElementById('passwordInput');

function openPasswordModal() {
  passwordModal.classList.add('show');
  passwordInput.value = '';
  passwordInput.focus();
}

function closePasswordModal(event) {
  if (event.target === passwordModal || event.target.classList.contains('cancel') || event.target.closest('.cancel')) {
    passwordModal.classList.remove('show');
  }
}

function checkPassword() {
  const entered = passwordInput.value.trim();
  if (entered === '2009') {
    passwordModal.classList.remove('show');
    devPanel.classList.add('open');
    loadSavedPhotos();
    updateVisitorDisplay(); // Update visitor log when opening
  } else {
    alert('Wrong password');
    passwordInput.value = '';
    passwordInput.focus();
  }
}

function closeDevPanel() {
  devPanel.classList.remove('open');
}

// ================== DEV TABS ==================
function switchDevTab(tabName) {
  document.getElementById('tabPhotos').classList.remove('active');
  document.getElementById('tabVisitors').classList.remove('active');
  document.getElementById('photosTab').classList.remove('active');
  document.getElementById('visitorsTab').classList.remove('active');
  
  if (tabName === 'photos') {
    document.getElementById('tabPhotos').classList.add('active');
    document.getElementById('photosTab').classList.add('active');
  } else {
    document.getElementById('tabVisitors').classList.add('active');
    document.getElementById('visitorsTab').classList.add('active');
    updateVisitorDisplay(); // Refresh when switching to visitors tab
  }
}

// ================== VISITOR DISPLAY ==================
function updateVisitorDisplay() {
  try {
    const visitors = JSON.parse(localStorage.getItem('visitor_log')) || [];
    
    // Update stats
    document.getElementById('totalVisits').textContent = visitors.length;
    
    if (visitors.length > 0) {
      const last = visitors[0];
      document.getElementById('lastVisitTime').textContent = `${last.date} ${last.time}`.toUpperCase();
    } else {
      document.getElementById('lastVisitTime').textContent = 'NEVER';
    }
    
    // Render visitor list
    const visitorList = document.getElementById('visitorList');
    if (visitors.length === 0) {
      visitorList.innerHTML = '<div class="empty-message">NO VISITORS YET</div>';
      return;
    }
    
    let html = '';
    visitors.forEach((visitor, index) => {
      const isFirst = index === 0 ? '‚≠ê ' : '';
      const browserIcon = visitor.browser === 'Chrome' ? 'üåê' : 
                         visitor.browser === 'Firefox' ? 'ü¶ä' : 
                         visitor.browser === 'Safari' ? 'üß≠' : 'üì±';
      
      html += `
        <div class="visitor-entry">
          <div class="visitor-info">
            <span class="visitor-email">${isFirst}${browserIcon} ${visitor.email}</span>
            <span class="visitor-time">${visitor.date} AT ${visitor.time}</span>
          </div>
          <div style="color:#666;">#${visitors.length - index}</div>
        </div>
      `;
    });
    
    visitorList.innerHTML = html;
  } catch (e) {
    console.log('Display error:', e);
  }
}

function clearAllLogs() {
  if (confirm('DELETE ALL VISITOR LOGS?')) {
    localStorage.removeItem('visitor_log');
    updateVisitorDisplay();
  }
}

// ================== PHOTO UPLOAD ==================
const photoGrid = document.getElementById('photoGrid');
const fileInput = document.getElementById('fileInput');
const STORAGE_KEY = 'kishor_dev_photos';

function loadSavedPhotos() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      renderPhotos(JSON.parse(saved));
    } else {
      photoGrid.innerHTML = '<p style="grid-column:1/-1; color:#aaa;">NO PHOTOS</p>';
    }
  } catch (e) {
    console.log('Photo load error:', e);
  }
}

function renderPhotos(photos) {
  photoGrid.innerHTML = '';
  if (!photos || photos.length === 0) {
    photoGrid.innerHTML = '<p style="grid-column:1/-1; color:#aaa;">NO PHOTOS</p>';
    return;
  }
  
  photos.forEach((src, index) => {
    const item = document.createElement('div');
    item.className = 'photo-item';
    item.innerHTML = `<img src="${src}"><div class="delete-photo" onclick="deletePhoto(${index})"><i class="fa-solid fa-trash"></i></div>`;
    photoGrid.appendChild(item);
  });
}

function handleFiles(files) {
  if (!files.length) return;
  
  const saved = localStorage.getItem(STORAGE_KEY);
  let existingPhotos = saved ? JSON.parse(saved) : [];
  
  Array.from(files).forEach(file => {
    if (!file.type.startsWith('image/')) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
      existingPhotos.push(e.target.result);
      
      // Limit to 50 photos
      if (existingPhotos.length > 50) {
        existingPhotos = existingPhotos.slice(-50);
      }
      
      localStorage.setItem(STORAGE_KEY, JSON.stringify(existingPhotos));
      renderPhotos(existingPhotos);
    };
    reader.readAsDataURL(file);
  });
}

function deletePhoto(index) {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    let photos = JSON.parse(saved);
    photos.splice(index, 1);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(photos));
    renderPhotos(photos);
  }
}

// ================== MUSIC ==================
const music = document.getElementById('bgMusic');
const musicEmoji = document.getElementById('musicEmoji');
music.volume = 0.5;

function toggleMusic() {
  if (music.paused) {
    music.play().catch(e => console.log('Audio play error:', e));
    musicEmoji.classList.add('rotate-emoji');
    musicEmoji.style.borderColor = 'gold';
    musicEmoji.style.boxShadow = '0 0 30px gold';
  } else {
    music.pause();
    musicEmoji.classList.remove('rotate-emoji');
    musicEmoji.style.borderColor = 'rgba(255,255,255,0.2)';
    musicEmoji.style.boxShadow = '0 5px 20px rgba(0,0,0,0.5)';
  }
}

// ================== PHOTO ZOOM ==================
const photoModal = document.getElementById('photoModal');
let isOpening = false;

function openPhoto() {
  if (isOpening) return;
  isOpening = true;
  photoModal.classList.add('show');
  document.body.style.overflow = 'hidden';
  if (navigator.vibrate) navigator.vibrate(50);
  setTimeout(() => { isOpening = false; }, 500);
}

function closePhoto(event) {
  if (event.target === photoModal || event.target.classList.contains('back-button') || event.target.closest('.back-button')) {
    const modalContent = document.querySelector('.modal-content');
    modalContent.style.transform = 'scale(0.5)';
    modalContent.style.opacity = '0';
    setTimeout(() => {
      photoModal.classList.remove('show');
      document.body.style.overflow = '';
      modalContent.style.transform = '';
      modalContent.style.opacity = '';
    }, 400);
  }
}

// ================== KEYBOARD SHORTCUTS ==================
document.addEventListener('keydown', function(e) {
  // Escape key for photo modal
  if (e.key === 'Escape' && photoModal.classList.contains('show')) {
    closePhoto({ target: photoModal });
  }
  
  // Space bar for music
  if (e.code === 'Space' && !e.target.matches('a') && !e.target.matches('button') && !e.target.matches('input')) {
    e.preventDefault();
    toggleMusic();
  }
  
  // Escape key for dev panel
  if (e.key === 'Escape' && devPanel.classList.contains('open')) {
    closeDevPanel();
  }
});

// ================== INITIALIZE ==================
// Track visitor immediately when page loads
trackVisitor();

// Also track when page becomes visible (if user switches tabs and comes back)
document.addEventListener('visibilitychange', function() {
  if (!document.hidden) {
    // Page is now visible, track this as a return visit
    console.log('User returned to page');
    // Optional: track return visits if you want
    // trackVisitor();
  }
});

console.log('Website loaded, visitor tracking active');
</script>
</body>
</html>
